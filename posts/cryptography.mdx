---
title: "The beautiful math behind encryption"
date: "2025-09-13"
publish: false
---

We use encryption all of the time and, as developers, libraries make it easy to implement. In fact, most of the time we don't even have to do anything, it's just invisibly already implemented in background. But that's not really satisfying for me. I like to know how things work - usually at a very granular level.

I've been to a few crytography meetups and have watched a few talks and it's always amazed me how the math _just_ works. I think most developers understand _how_ encryption works but I think very few developers understand _why_ it works. And even fewer understand the math that makes it work.

Cryptography is a broad field that includes many different types of encryption schemes. In this post, we’ll focus on Elliptic Curve Cryptography (ECC), specifically within the context of Asymmetric Encryption and the math that makes it work.

Let's dive in.

# Asymmetric Encryption 101

Just to make sure that we're on the same page, let's do a quick primer on asymmetric encryption.

Asymmetric encryption, or sometimes called Public Key Encryption, uses a pair of keys - a public key and a private key, to securely encrypt and decrypt data.

![asymmtric](/asymm.png)

What makes it powerful is that the keys are mathematically linked. So you can share the public key with anyone in the world (hence:"public") and they can use it to encrypt a message that only the private key can decrypt.

Many protocols such as TLS, SSH, Signal, WireGuard and others use asymmetric encyryption for authentication/key exchange before switching to symmetric encryption for data encryption. This hybrid approach is pretty common.

Elliptic curve cryptography (which we'll get to in a second, I promise!), is just one way of doing asymmetric encryption. There are other ways such as RSA, Kyber, and Finite-field Diffie-Hellman but ECC is quickly becoming the standard.

Okay, great, now onto the fun stuff.

# What is an Elliptic Curve?

An elliptic curve is a mathematical curve that is typically defined by a cubic equation such as:

$y^{2}=x^{3}+ax+b$

![ecc](/ecc.png)

In elliptic curve crytography, we work with elliptic curves which are **nonsingular** cubic curves with a point at infinity over a finite field . These non-singular cubic curves have a few pretty cool characteristics that make them very useful in crytography:

1. The curve never intersects with itself
2. The point at infinity acts like a zero and it allows us to add points on the curve together
3. Every point on the curve has an inverse
4. If points $P$, $Q$ are on the curve then $P + Q$ is on the curve as well. This enables scalar multiplication of points and ensures that we never leave the curve.
5. The curve must be **Associative** such that $(P+Q)+R = P+(Q+R)$. This lets us sum points without worrying about paranthesis and the order of the points.
6. The curve must support **Commutativity** meaning that $P+Q = Q+P$. This just makes the math easier.

We'll see why these features are critical for ECC to work is just a bit.

One last thing, I mentioned above that we work with elliptic curves over a finite field. What does this mean?

It means that the elliptic curves that we work with in practice look less like the image above and more like this:

![ecc](/eccbase.png)

This is a view of the elliptic curve $y^2 \equiv x^3 - x + 1$ but over $\mathbb{F}_{23}$. You can actually see that every point in the curve has an inverse in the graph if you were to draw a horizontal line at $y = 11$ like so.

![ecc](/eccbasepair.png)

For our purposes, we'll use the first picture because it's easier to show why the math works but just remember that in practice we define elliptic curves over finite fields so they look more like the second picture.

(If you're interested in reading more in depth about elliptic curves, [this is free book.](http://tomlr.free.fr/Math%E9matiques/Math%20Complete/Cryptography/Guide%20to%20Elliptic%20Curve%20Cryptography%20-%20D.%20Hankerson,%20A.%20Menezes,%20S.%20Vanstone.pdf))

# Beautiful Symmetry

In the section above, we talked about how every point in an elliptic curve has an inverse point which means that every point can be reflected over the X-axis and will still be on the same curve. This creates symmetry which we can express as:

For every point $P = (x,y)$, the inverse is $-P=(x,-y\bmod p)$

**Quite note**: We use $-y\bmod p$, since in ECC all arithmetic happens in a finite field $\mathbb F_p$, and elements of $\mathbb F_p$ are integers modulo p.

This symmetry has a few very important features that make the math behind ECC work.

The first is that any non-vertical line will intersect the curve in at most three places.

![ecc](/3inters.png)

Above, we plot the elliptic curve $y^2=x^3-x+1$ and then line $y=-2.5x-2$. You can see that it only intersects at 3 different points.

We can also derive this mathematically. Substitute a line:

$y=mx+c$ into $y^2=x^3-x+1$ and you get: $(mx+c)^2=x^3-x+1$,

Which is a a **cubic equation in $x$**. You can see that it has the same form as the elliptic curve equation above. A cubic has ≤ 3 real roots, so a non-vertical line hits the curve in **at most three** real $x$’s.

The second is what we call the **chord-and-tangent** addition law.

The chord-and-tangent addition law says that if you plot two points on the curve: $P$ and $Q$, and then draw a line through them, they will intersect at $R$. We can then reflect $R$ across the X-axis to get it's inverse (which we proved at the beginning of the section) and then state that $P+Q = -R$.

![ecc](/chord.png)

Why is this important?

Reflecting the third intersection across the x-axis gives a closed, invertible addition rule with the point at infinity as the identity. This turns curve points into an abelian group, which is exactly the algebra ECC needs for well-defined, efficient scalar multiplication $Q=k⋅G.$

This also works where $P = Q$. Instead of the drawing a line to connect $P$ and $Q$, you can just take the tangent at $P$, and where that tangent line intersects with the curve, we can call $R$.

![ecc](/tangent.png)

Following the same math as above where we reflect $R$ over the X-axis, we get $2P = -R$.

Now for the beauty of scalar multiplication with abelian groups on elliptic curves.

You can very easily and quickly perform many scalar multiplications in the form $Q=k⋅G.$.
